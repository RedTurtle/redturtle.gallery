<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">
    <body>
        <metal:main fill-slot="main"
                    tal:define="portal context/@@plone_portal_state/portal">

            <div class="gallery-modal-wrapper">
                <div class="gallery-slider pat-slider"
                     data-pat-slider='{
                                        "initialSlide": ${view/itemIndex},
                                        "slidesToShow": 1,
                                        "slidesToScroll": 1
                                      }'>

                    <tal:images repeat="brain view/contents">
                        <div class="gallery-item"
                             tal:define="title brain/Title;
                                         imgUrl brain/absolute_url">
                            <figure class="item-image">
                                <img tal:attributes="alt title;
                                                     src imgUrl">
                            </figure>
                            <div class="item-title">
                                <span tal:content="title">title</span>
                            </div>
                        </div>
                    </tal:images>

                    <script type="text/javascript">
                        $('.gallery-slider').on('init', function(e) {
                            setTimeout(function() {
                                $('.slick-active').focus();

                                var inputs = $('.gallery-slider').find('select, input, textarea, button, a');
                                var firstInput = inputs.first();
                                var lastInput = inputs.last();

                                lastInput.on('keydown', function(e) {
                                    if (e.which === 9) {
                                        if (!e.shiftKey) {
                                            e.preventDefault();
                                            firstInput.focus();
                                        }
                                    }
                                });

                                firstInput.on('keydown', function(e) {
                                    if (e.which === 9) {
                                        if (e.shiftKey) {
                                            e.preventDefault();
                                            lastInput.focus();
                                        }
                                    }
                                });
                            }, 100);
                        });
                    </script>

                </div>
            </div>

        </metal:main>
    </body>
</html>
